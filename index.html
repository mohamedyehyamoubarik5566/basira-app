<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basira App</title>
    <link href="./bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="./style.css" rel="stylesheet">
    <link href="./home-styles.css" rel="stylesheet">
    <link href="./client-statement-2026.css" rel="stylesheet">
    <link href="./logout-style.css" rel="stylesheet">
    <link href="./report-styles.css" rel="stylesheet">
    <link rel="stylesheet" href="./update-styles.css">
    <link rel="stylesheet" href="./update-modal-styles.css">
    
    <!-- System Configuration - MUST BE FIRST -->
    <script>
        // System Configuration - Inline to ensure availability
        const SystemConfig = {
            version: {
                current: '2026.1.1',
                apiVersion: 'v1',
                schemaVersion: '1.0.0',
                lastUpdate: '2024-12-19T10:00:00Z'
            },
            system: {
                maintenanceMode: false,
                sessionTimeout: 30 * 60 * 1000
            }
        };
        
        // Make globally available
        if (typeof window !== 'undefined') {
            window.SystemConfig = SystemConfig;
        }
    </script>
    
    <!-- CryptoJS Library for Security -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    
    <!-- Enhanced Core System Files -->
    <script src="./config.js"></script>
    <script src="./security.js"></script>
    <script src="./utils-enhanced.js"></script>
    <script src="./performance-enhanced.js"></script>
    <script src="./database-config-simple.js"></script>
    <script src="./clear-data.js"></script>
    <script src="./script-inline.js"></script>

</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h4>Basira App</h4>
            <p class="subtitle">نظام إدارة المبيعات المتطور</p>
        </div>
        <nav>
            <a href="#" class="nav-item active" data-section="dashboard">
                <i class="fas fa-home"></i>
                <span>الرئيسية</span>
            </a>
            <a href="#" class="nav-item" data-section="sales">
                <i class="fas fa-shopping-cart"></i>
                <span>المبيعات</span>
            </a>
            <a href="#" class="nav-item" data-section="clients">
                <i class="fas fa-users"></i>
                <span>العملاء</span>
            </a>
            <a href="#" class="nav-item" data-section="purchases">
                <i class="fas fa-shopping-bag"></i>
                <span>المشتريات</span>
            </a>
            <a href="#" class="nav-item" data-section="budget">
                <i class="fas fa-chart-pie"></i>
                <span>الميزانية المالية</span>
            </a>
            <a href="#" class="nav-item" data-section="treasury">
                <i class="fas fa-wallet"></i>
                <span>الخزينة</span>
            </a>
            <a href="#" class="nav-item" data-section="daily-report">
                <i class="fas fa-chart-bar"></i>
                <span>التقرير اليومي</span>
            </a>
            <a href="#" class="nav-item" data-section="bank">
                <i class="fas fa-university"></i>
                <span>البنوك والشيكات</span>
            </a>
            <a href="#" class="nav-item" data-section="vehicles">
                <i class="fas fa-truck"></i>
                <span>السيارات</span>
            </a>
            <a href="staff.html" class="nav-item">
                <i class="fas fa-user-tie"></i>
                <span>إدارة الموظفين</span>
            </a>
            <a href="control-panel.html" class="nav-item">
                <i class="fas fa-cogs"></i>
                <span>لوحة التحكم</span>
            </a>
            <a href="#" class="nav-item" data-section="settings">
                <i class="fas fa-cog"></i>
                <span>الإعدادات</span>
            </a>
        </nav>
        
        <div class="sidebar-version">
            Powered by <a href="#" onclick="showDeveloperInfo()">البصيرة للتقنية</a> | v<span id="appVersion">1.0.0</span>
        </div>
        
        <div class="sidebar-footer">
            <div class="user-profile">
                <div class="user-avatar">A</div>
                <div class="user-info">
                    <div class="name" id="currentUserName">المدير</div>
                    <div class="role" id="currentUserRole">مدير النظام</div>
                </div>
                <button class="logout-btn" onclick="logout()" title="تسجيل الخروج">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header class="header">
            <h5 id="pageTitle">Dashboard</h5>
            <span id="currentDate"></span>
        </header>

        <div class="content">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="content-section active">
                <div class="home-container">
                    <!-- Welcome Section -->
                    <div class="welcome-section">
                        <h1 class="welcome-title">مرحباً بك في نظام البصيرة ERP</h1>
                        <p class="welcome-text">
                            نظام إدارة موارد المؤسسات المتقدم - الإصدار 2.0<br>
                            مع تحسينات الأمان والأداء والميزات المتطورة
                        </p>
                        
                        <div class="system-info">
                            <div class="info-item">
                                <div class="info-label">إصدار النظام</div>
                                <div class="info-value" id="systemVersion">2.0.1</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">آخر تحديث</div>
                                <div class="info-value">ديسمبر 2024</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">المستخدم الحالي</div>
                                <div class="info-value" id="currentUserDisplay">المدير</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">حالة النظام</div>
                                <div class="info-value" style="color: #10b981;">نشط</div>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics Overview -->
                    <div class="stats-overview">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-value" id="dashboardTotalSales">0 ج.م</div>
                            <div class="stat-label">إجمالي المبيعات اليوم</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-value" id="dashboardTotalClients">0</div>
                            <div class="stat-label">العملاء النشطين</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-truck"></i>
                            </div>
                            <div class="stat-value" id="dashboardTotalOrders">0</div>
                            <div class="stat-label">الطلبات اليوم</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="stat-value" id="dashboardTotalBalance">0 ج.م</div>
                            <div class="stat-label">رصيد الخزينة</div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="quick-actions">
                        <div class="action-card" onclick="navigateToSection('sales')">
                            <div class="action-icon">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div class="action-title">إضافة مبيعة</div>
                            <div class="action-desc">إنشاء إذن مبيعة جديد</div>
                        </div>
                        
                        <div class="action-card" onclick="navigateToSection('clients')">
                            <div class="action-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div class="action-title">إضافة عميل</div>
                            <div class="action-desc">تسجيل عميل جديد</div>
                        </div>
                        
                        <div class="action-card" onclick="navigateToSection('treasury')">
                            <div class="action-icon">
                                <i class="fas fa-money-bill"></i>
                            </div>
                            <div class="action-title">إدارة الخزينة</div>
                            <div class="action-desc">متابعة الإيرادات والمصروفات</div>
                        </div>
                        
                        <div class="action-card" onclick="navigateToSection('daily-report')">
                            <div class="action-icon">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="action-title">التقارير</div>
                            <div class="action-desc">عرض التقارير اليومية</div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="recent-activity">
                        <div class="activity-header">
                            <h2 class="activity-title">النشاط الأخير</h2>
                            <button class="modern-btn secondary" onclick="refreshActivity()">
                                <i class="fas fa-sync-alt"></i>
                                تحديث
                            </button>
                        </div>
                        
                        <div class="activity-list" id="recentActivityList">
                            <!-- سيتم ملء النشاط الأخير هنا -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sales Section -->
            <div id="sales-section" class="content-section">
                <div class="sales-header">
                    <h1>نظام إدارة المبيعات</h1>
                    <button class="modern-btn primary" onclick="openPermissionModal()">
                        <i class="fas fa-file-plus"></i>
                        إضافة إذن
                    </button>
                </div>
                <div class="data-table-container">
                    <table class="modern-table">
                        <thead>
                            <tr>
                                <th>رقم الإذن</th>
                                <th>العميل</th>
                                <th>رقم السيارة</th>
                                <th>نوع المادة</th>
                                <th>التكعيب</th>
                                <th>سعر المتر</th>
                                <th>سعر النقلة</th>
                                <th>الوقت</th>
                                <th>الإجراءات</th>
                            </tr>
                        </thead>
                        <tbody id="salesTable"></tbody>
                    </table>
                </div>
            </div>

            <!-- Clients Section -->
            <div id="clients-section" class="content-section">
                <div class="clients-header">
                    <h1>إدارة العملاء</h1>
                    <button class="modern-btn primary" onclick="openClientModal()">
                        <i class="fas fa-user-plus"></i>
                        إضافة عميل
                    </button>
                </div>
                <div class="clients-grid" id="clientsGrid"></div>
            </div>

            <!-- Other Sections -->
            <div id="purchases-section" class="content-section">
                <h1>المشتريات</h1>
            </div>
            <div id="budget-section" class="content-section">
                <h1>الميزانية المالية</h1>
            </div>
            <div id="treasury-section" class="content-section">
                <h1>إدارة الخزينة</h1>
            </div>
            <div id="daily-report-section" class="content-section">
                <h1>التقرير اليومي</h1>
            </div>
            <div id="bank-section" class="content-section">
                <h1>إدارة البنوك والشيكات</h1>
            </div>
            <div id="vehicles-section" class="content-section">
                <h1>بيانات السيارات</h1>
            </div>
            <div id="settings-section" class="content-section">
                <h1>الإعدادات</h1>
            </div>
        </div>
    </div>

    <!-- Permission Modal -->
    <div class="modal-overlay" id="permissionModal">
        <div class="permission-modal">
            <div class="modal-header">
                <h2>إضافة إذن جديد</h2>
                <button class="close-btn" onclick="closePermissionModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="permission-form" id="permissionForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>اسم العميل</label>
                        <input type="text" id="clientName" required>
                    </div>
                    <div class="form-group">
                        <label>رقم الإذن</label>
                        <input type="text" id="permissionNumber" required>
                    </div>
                    <div class="form-group">
                        <label>رقم السيارة</label>
                        <input type="text" id="carNumber" required>
                    </div>
                    <div class="form-group">
                        <label>نوع المادة</label>
                        <input type="text" id="materialType" required>
                    </div>
                    <div class="form-group">
                        <label>التكعيب</label>
                        <input type="number" id="volume" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>سعر المتر</label>
                        <input type="number" id="pricePerMeter" step="0.01" required>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closePermissionModal()">إلغاء</button>
                    <button type="submit" class="save-btn">حفظ الإذن</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Client Modal -->
    <div class="modal-overlay" id="clientModal">
        <div class="permission-modal">
            <div class="modal-header">
                <h2>إضافة عميل جديد</h2>
                <button class="close-btn" onclick="closeClientModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="permission-form" id="clientForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>اسم العميل</label>
                        <input type="text" id="clientNameInput" required>
                    </div>
                    <div class="form-group">
                        <label>رقم الهاتف</label>
                        <input type="tel" id="clientPhone">
                    </div>
                    <div class="form-group">
                        <label>سعر السن</label>
                        <input type="number" id="clientPriceSen" step="0.01" required>
                    </div>
                    <div class="form-group">
                        <label>سعر العدسة</label>
                        <input type="number" id="clientPriceAdasa" step="0.01" required>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="cancel-btn" onclick="closeClientModal()">إلغاء</button>
                    <button type="submit" class="save-btn">حفظ العميل</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Application Script -->
    <script src="./script-main.js"></script>
    <script src="./script-functions.js"></script>
    
</body>
</html>